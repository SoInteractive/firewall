---
- hosts: all
  tasks:
  - name: install packages
    package:
      name: "{{ item }}"
      state: present
    with_items:
      - iproute
      - iptables
  - name: ensure auth.log exists in container
    command: touch /var/log/auth.log
    args:
      creates: /var/log/auth.log
  - name: add iptables chain
    command: iptables -N DOCKER

- hosts: all
  gather_facts: yes
  roles:
    - ansible-firewall
  vars:
    firewall_fail2ban_force: True
    firewall_fail2ban_exclude:
    - 0.0.0.0/0
    firewall_env_subnet: 0.0.0.0/0
